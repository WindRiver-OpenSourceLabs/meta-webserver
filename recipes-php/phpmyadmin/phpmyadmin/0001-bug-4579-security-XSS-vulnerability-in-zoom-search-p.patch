From 1bc04ec95038f2356ad33752090001bf1c047208 Mon Sep 17 00:00:00 2001
From: Madhura Jayaratne <madhura.cj@gmail.com>
Date: Thu, 20 Nov 2014 06:28:43 +0530
Subject: [PATCH] bug #4579 [security] XSS vulnerability in zoom search page

(Upstream commit 1bc04ec95038f2356ad33752090001bf1c047208)

Upstream-Status: Backport

Signed-off-by: Madhura Jayaratne <madhura.cj@gmail.com>
Signed-off-by: Yue Tao <yue.tao@windriver.com>
---
 ChangeLog           |    1 +
 tbl_zoom_select.php |    2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/ChangeLog b/ChangeLog
index a5e3033..001e9fa 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -6,6 +6,7 @@ phpMyAdmin - ChangeLog
 - bug #4562 [security] XSS in debug SQL output
 - bug #4563 [security] XSS in monitor query analyzer
 - bug #4594 [security] Path traversal in file inclusion of GIS factory
+- bug #4579 [security] XSS vulnerability in zoom search page
 
 4.2.7.1 (2014-08-17)
 - bug #4505 [security] XSS in view operations page
diff --git a/tbl_zoom_select.php b/tbl_zoom_select.php
index 7f4ceea..7bbaab7 100644
--- a/tbl_zoom_select.php
+++ b/tbl_zoom_select.php
@@ -81,7 +81,7 @@ if (isset($_REQUEST['change_tbl_info']) && $_REQUEST['change_tbl_info'] == true)
     }
     $key = array_search($field, $table_search->getColumnNames());
     $properties = $table_search->getColumnProperties($_REQUEST['it'], $key);
-    $response->addJSON('field_type', $properties['type']);
+    $response->addJSON('field_type', htmlspecialchars($properties['type']));
     $response->addJSON('field_collation', $properties['collation']);
     $response->addJSON('field_operators', $properties['func']);
     $response->addJSON('field_value', $properties['value']);
-- 
1.7.9.5

