From d32da348c4de2379482a48661ce968a55eebe5c4 Mon Sep 17 00:00:00 2001
From: Madhura Jayaratne <madhura.cj@gmail.com>
Date: Thu, 20 Nov 2014 06:26:55 +0530
Subject: [PATCH] bug #4578 [security] XSS vulnerability in table print view

(Upstream commit d32da348c4de2379482a48661ce968a55eebe5c4)

Upstream-Status: Backport

Signed-off-by: Madhura Jayaratne <madhura.cj@gmail.com>
Signed-off-by: Yue Tao <yue.tao@windriver.com>
---
 ChangeLog                       |    1 +
 libraries/tbl_printview.lib.php |    2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/ChangeLog b/ChangeLog
index 2983177..a5e3033 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -7,6 +7,7 @@ phpMyAdmin - ChangeLog
 - bug #4563 [security] XSS in monitor query analyzer
 - bug #4594 [security] Path traversal in file inclusion of GIS factory
 - bug #4579 [security] XSS vulnerability in zoom search page
+- bug #4578 [security] XSS vulnerability in table print view
 
 4.2.7.1 (2014-08-17)
 - bug #4505 [security] XSS in view operations page
diff --git a/libraries/tbl_printview.lib.php b/libraries/tbl_printview.lib.php
index a4a81eb..0176f40 100644
--- a/libraries/tbl_printview.lib.php
+++ b/libraries/tbl_printview.lib.php
@@ -107,7 +107,7 @@ function PMA_getHtmlForPrintViewColumns(
             $html .= '    ' . $field_name . "\n";
         }
         $html .= '</td>';
-        $html .= '<td>' . $type . '<bdo dir="ltr"></bdo></td>';
+        $html .= '<td>' . htmlspecialchars($type) . '<bdo dir="ltr"></bdo></td>';
         $html .= '<td>';
         $html .= (($row['Null'] == '' || $row['Null'] == 'NO')
             ? __('No')
-- 
1.7.9.5

